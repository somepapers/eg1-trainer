<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>EG1 Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: system-ui, sans-serif;
  margin: 0;
  padding: 12px;
  background: #f7f7f7;
}
button {
  padding: 8px 14px;
  margin: 4px;
  font-size: 16px;
}
.case-box {
  margin: 6px 0;
}
.scramble {
  font-size: 18px;
  margin: 12px 0;
  word-break: break-word;
}
.msg {
  font-size: 20px;
  margin: 10px 0;
  font-weight: bold;
}
.hidden {
  display: none;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 16px;
}
td, th {
  border: 1px solid #ccc;
  padding: 4px;
  font-size: 12px;
}
</style>
</head>
<body>

<div>
  <button onclick="showPage(1)">打乱</button>
  <button onclick="showPage(2)">统计</button>
</div>

<!-- 页面1 -->
<div id="page1">
  <h3>EG1 打乱生成</h3>

  <div>
    <strong>选择 Case：</strong><br>
    <span id="caseSelect"></span>
  </div>

  <div class="scramble" id="scramble"></div>
  <div class="msg" id="msg"></div>

  <button onclick="prevScramble()">上一条</button>
  <button onclick="nextScramble()">下一条</button><br>
  <button onclick="copyScramble()">复制打乱</button><br><br>

  <button onclick="correct()">做对了</button>
  <button onclick="wrong()">做错了</button>
</div>

<!-- 页面2 -->
<div id="page2" class="hidden">
  <h3>统计</h3>
  <div id="stats"></div>
</div>

<script>
/* ========= 数据 ========= */

const DATA = {
  H: [
    ["F' R' F R F R' F' R2 U R'", "R U' R2 F R F' R' F' R F", "R' F R2 U' R' F R U R' F'", "F R U' R' F' R U R2 F' R"],
    ["F' U R U' R2 F2 R U' F", "R U' R' U' R U' R2 F2 R U R U R'", "F U' R' F R2 U2 R' U F'"],
    ["R' F R F' U2 F R U2 R' F", "R' U' R' F2 U F' R F'", "R U' R' F U2 F' R' F2 R F'"],
    ["R U R' F' R U R' U' R U R'", "F2 U' R U R2 F' R U' F", "R' F R F' R' F R U' R' F R F'", "F' R' F R U2 R U R' U' R U R'", "F2 U R' F' R2 U R' U F'"]
  ],
  Pi: [
    ["F U' R' F R U' F2 R U R'", "R2 B2 R' U R' U' R U2 R U' R2"],
    ["R U R2 F' R2 U R'", "R U' R2 F R2 U' R"],
    ["F' R U2 R' F' U2 F R' F' R"],
    ["R' F R U' R' F R F' R' F R", "F' R U R' U' R U R' F' R U R'", "F R' F' R U R' F' R F R' F' R"],
    ["F R U' R' U' F' R U R2 F' R", "F U' R U2 R' F' R U R' F'", "F' R' F R F' R' F2 R U' F"],
    ["R' F' R U' R' F R2 U R' F' R U R'", "F R U' R' F R U2 R' U F'", "F' U R' F2 R F R' F' R F", "F' R' F R U F R' F' R2 U R'"]
  ],
  T: [
    ["F R U' R2 F' R U R' F' R", "R U' R2 F R2 U R' U2 R' F R F'", "R U2 R' U' R' F' R F R' F' R"],
    ["R U' R' U2 R U2 R' F R U' R'", "R U R' F' U2 R U R' U' R U R'", "R' F2 R U R U R' F' R U R'"],
    ["R U2 R' U' R' F' R2 U R'", "R' F R2 U' R' U' R' F2 R", "R' F2 R U R U R2 F' R"],
    ["R' F R F' U R U' R' U' R' F' R F"],
    ["R U2 R2 F R2 U' R' F' R U R'", "R' F' R2 U R' F' R U R'", "R' F2 R2 U' R2 F R F R' F' R"],
    ["F' R U2 R' F' U2 R U R'", "R' F R U2 F' R' F2 R F'", "F R' F2 R F U2 R' F' R"]
  ],
  L: [
    ["R U R' F' R U2 R' U2 R U R'", "R U' R' F R U' R' U' R' F2 R"],
    ["F' R' F R F R' F' R F R' F' R", "R' F R F' R' F R U R U2 R'", "F R' F' R U2 R U' R2 F' R2 U R'"],
    ["R U R2 F' U R2 U R2 U' R"],
    ["R' F R2 U R' F' R U2 R'", "R' F2 R F' R' F R2 U R'", "R U' R2 F' R F R' F2 R"],
    ["R U R' F' R U R' U' F R' F' R", "F' R' F R U' R U R' U' R U R'"],
    ["R' F' R F U' R' F' R U R' F' R", "F R U' R' U R' F' R U R' F' R"]
  ],
  U: [
    ["R U R' U R U' R2 F' R2 U R'", "R U R2 F' R U' R U' R' U R U R'", "R U' R' U' R U R' U R' F R2 U' R'"],
    ["R U R' F' U' R U R' U' F R' F' R", "F' R' F R U R U R' U' F R' F' R"],
    ["R U' R' U' F R' F2 R2 U R'", "F' U2 R U2 R' U2 F"],
    ["R U' R' F R U' R2 F R"],
    ["R' F R F' U R U' R' F R U' R'", "R U' R' U R U' R' U' F R U' R'"],
    ["R U' R' F U' R' F R F' R' F R", "R' F R U' R' F R U F' R' F R"]
  ],
  S: [
    ["R U' R2 F' R F U R' F R"],
    ["R U R' F2 U F R U R'", "F' R' F R U' R U R' U' F R' F' R", "R' F' R F R' U2 R U' R2 F R2"],
    ["R' F R U2 R U' R2 F2 R F'"],
    ["F' U R U' R' U F R U R'", "R U' R' F U' R' F R2 U R' F'", "R' F' R U2 R U R' F' R U' R'"],
    ["R U R' F R U' R' U R' F2 R", "R U' R' U R U' R' U F R U' R'", "R U' R' U R U' R' U' R' F' R F"],
    ["F' R' F R2 U2 R U2 R U R'"]
  ],
  AS: [
    ["R' F' R U' F' R' F R2 U R'"],
    ["R U' R' F' U' F2 R U' R'", "F R U' R' U R' F' R U F' R U R'", "F' U' F2 R' F2 R2 U R'"],
    ["R U' R' U2 R U2 R2 F' R F"],
    ["R U' R' F' U' R U R' U' F", "F R U' R2 F' R U F' R U R'", "R U R' F R U' R' U2 R' F R"],
    ["F' R' F R U R U R' U' R U R'", "R U F' R U R2 U' R U R'", "R U R' U2 R' F' R F R' F R"],
    ["R U R' F' U' R U R' U' R U R'"]
  ]
};

/* ========= 工具 ========= */

const invert = alg =>
  alg.split(" ").reverse().map(m =>
    m.includes("'") ? m.replace("'", "") :
    m.includes("2") ? m :
    m + "'"
  ).join(" ");

let history = [];
let index = -1;
let lastKey = "";

const stat = JSON.parse(localStorage.getItem("eg1_stat") || "{}");

/* ========= 初始化 ========= */

const cases = Object.keys(DATA);
const cs = document.getElementById("caseSelect");
cases.forEach(c => {
  const cb = document.createElement("input");
  cb.type = "checkbox";
  cb.checked = true;
  cb.value = c;
  cs.appendChild(cb);
  cs.append(c + " ");
});

/* ========= 核心 ========= */

function pick() {
  const enabled = [...cs.querySelectorAll("input:checked")].map(i => i.value);
  let c, i, j, key;
  do {
    c = enabled[Math.floor(Math.random() * enabled.length)];
    i = Math.floor(Math.random() * DATA[c].length);
    j = Math.floor(Math.random() * DATA[c][i].length);
    key = c + "-" + i;
  } while (key === lastKey);
  lastKey = key;
  return { c, i, j };
}

function showScramble(o) {
  const s = invert(DATA[o.c][o.i][o.j]);
  document.getElementById("scramble").innerText = s;
  document.getElementById("msg").innerText = "";
}

function nextScramble() {
  const o = pick();
  history = history.slice(0, index + 1);
  history.push(o);
  index++;
  showScramble(o);
}

function prevScramble() {
  if (index > 0) {
    index--;
    showScramble(history[index]);
  }
}

function correct() {
  const o = history[index];
  const k = o.c + "-" + o.i + "-" + o.j;
  stat[k] = stat[k] || { c: 0, w: 0 };
  stat[k].c++;
  save();
  document.getElementById("msg").innerText = "蒸蚌";
  setTimeout(nextScramble, 2500);
}

function wrong() {
  const o = history[index];
  const k = o.c + "-" + o.i + "-" + o.j;
  stat[k] = stat[k] || { c: 0, w: 0 };
  stat[k].w++;
  save();
  document.getElementById("msg").innerText =
    DATA[o.c][o.i][o.j] + "\n菜就多练";
}

function copyScramble() {
  navigator.clipboard.writeText(
    document.getElementById("scramble").innerText
  );
}

function save() {
  localStorage.setItem("eg1_stat", JSON.stringify(stat));
}

function showPage(n) {
  page1.classList.toggle("hidden", n !== 1);
  page2.classList.toggle("hidden", n !== 2);
  if (n === 2) renderStats();
}

function renderStats() {
  const box = document.getElementById("stats");
  box.innerHTML = "";
  for (const k in stat) {
    const s = stat[k];
    const t = s.c + s.w;
    const r = t ? ((s.c / t) * 100).toFixed(1) : "0";
    box.innerHTML += `<div>${k}：✔${s.c} ✘${s.w} (${r}%)</div>`;
  }
}

nextScramble();
</script>
</body>
</html>









